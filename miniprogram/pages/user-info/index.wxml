<!-- 个人信息编辑页面 -->
<view class="container">
  <!-- 头像区域 -->
  <view class="avatar-section">
    <view class="avatar-wrapper" bind:tap="changeAvatar">
      <image class="avatar" src="{{userInfo.avatar || '/assets/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="avatar-edit-icon">
        <text class="icon">📷</text>
      </view>
    </view>
    <text class="avatar-tip">点击更换头像</text>
  </view>

  <!-- 表单区域 -->
  <view class="form-section">
    <!-- 昵称 -->
    <view class="form-item">
      <view class="form-label">昵称</view>
      <input 
        class="form-input" 
        type="text" 
        value="{{userInfo.nickName}}"
        placeholder="请输入昵称"
        maxlength="20"
        data-field="nickName"
        bind:input="onInputChange"
      />
    </view>

    <!-- 部门 -->
    <view class="form-item">
      <view class="form-label">部门</view>
      <input 
        class="form-input" 
        type="text" 
        value="{{userInfo.department}}"
        placeholder="请输入部门"
        maxlength="30"
        data-field="department"
        bind:input="onInputChange"
      />
    </view>

    <!-- 手机号 -->
    <view class="form-item">
      <view class="form-label">手机号</view>
      <input 
        class="form-input" 
        type="number" 
        value="{{userInfo.phone}}"
        placeholder="请输入手机号"
        maxlength="11"
        data-field="phone"
        bind:input="onInputChange"
      />
    </view>

    <!-- 邮箱 -->
    <view class="form-item">
      <view class="form-label">邮箱</view>
      <input 
        class="form-input" 
        type="text" 
        value="{{userInfo.email}}"
        placeholder="请输入邮箱"
        maxlength="50"
        data-field="email"
        bind:input="onInputChange"
      />
    </view>

    <!-- 角色（只读） -->
    <view class="form-item">
      <view class="form-label">角色</view>
      <view class="form-value readonly">{{roleText}}</view>
    </view>

    <!-- 状态 -->
    <view class="form-item" bind:tap="selectStatus">
      <view class="form-label">状态</view>
      <view class="form-value with-arrow">
        <text class="status-dot {{userInfo.status}}"></text>
        <text>{{statusText}}</text>
        <text class="arrow">›</text>
      </view>
    </view>
  </view>

  <!-- 按钮区域 -->
  <view class="button-section">
    <button class="save-btn" bind:tap="saveUserInfo" disabled="{{!hasChanges || saving}}">
      {{saving ? '保存中...' : '保存修改'}}
    </button>
    <button class="cancel-btn" bind:tap="cancel">取消</button>
  </view>
</view>

<!-- TDesign Toast -->
<t-toast id="t-toast" />